<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>在Kubernetes(k8s)集群上安装部署istio1.14 -</title><meta name=Description content="安装"><meta property="og:title" content="在Kubernetes(k8s)集群上安装部署istio1.14"><meta property="og:description" content="安装"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.yudlk.com/posts/istio/002-install/"><meta property="og:image" content="https://blog.yudlk.com/img/jinx.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-03T00:00:00+00:00"><meta property="article:modified_time" content="2023-02-03T00:00:00+00:00"><meta property="og:site_name" content="qpt的个人博客"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.yudlk.com/img/jinx.png"><meta name=twitter:title content="在Kubernetes(k8s)集群上安装部署istio1.14"><meta name=twitter:description content="安装"><meta name=application-name content="面对疾风"><meta name=apple-mobile-web-app-title content="面对疾风"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.yudlk.com/posts/istio/002-install/><link rel=prev href=https://blog.yudlk.com/posts/istio/001-describe/><link rel=stylesheet href=/css/style.min.cf6878db51c51b2d04ae155284a4403dbee8db33e16c066f954c95279c271fcd.css integrity="sha256-z2h421HFGy0ErhVShKRAPb7o2zPhbAZvlUyVJ5wnH80="><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"在Kubernetes(k8s)集群上安装部署istio1.14","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.yudlk.com\/posts\/istio\/002-install\/"},"image":["https:\/\/blog.yudlk.com\/img\/jinx.png"],"genre":"posts","keywords":"istio","wordcount":6690,"url":"https:\/\/blog.yudlk.com\/posts\/istio\/002-install\/","datePublished":"2023-02-03T00:00:00+00:00","dateModified":"2023-02-03T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"qpt"},"description":"安装"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark')&&document.body.setAttribute('theme','dark')</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title>面对疾风</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/ title=面对疾风>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/about/ title=关于>关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title>面对疾风</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title=面对疾风>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/about/ title=关于>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">在Kubernetes(k8s)集群上安装部署istio1.14</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/barrypt title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>qpt</a></span>&nbsp;<span class=post-category>included in <a href=/categories/istio/><i class="far fa-folder fa-fw" aria-hidden=true></i>istio</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-02-03>2023-02-03</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;6690 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;14 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#一模块概览>一.模块概览</a></li><li><a href=#二系统环境>二.系统环境</a></li><li><a href=#三安装istio>三.安装istio</a></li><li><a href=#四getmesh>四.GetMesh</a></li><li><a href=#五-发现选择器discovery-selectors>五. 发现选择器(Discovery Selectors)</a></li><li><a href=#六实战k8s集群安装istio-114版本>六.实战（k8s集群安装Istio 1.14版本）</a></li></ul></nav></div></div><div class=content id=content><p>Istio(二)：在Kubernetes(k8s)集群上安装部署istio1.14</p><h2 id=一模块概览>一.模块概览</h2><p>在安装 Istio 模块中，我们将介绍在 Kubernetes 集群上安装 Istio1.14 的不同方法。我们将通过详细的步骤，了解如何在 Kubernetes 集群上安装 Istio。</p><p>关于istio简介可以查看博客《Istio(一)：服务网格和 Istio 概述》https://www.cnblogs.com/renshengdezheli/p/16836205.html</p><h2 id=二系统环境>二.系统环境</h2><table><thead><tr><th>服务器版本</th><th>docker软件版本</th><th>Kubernetes(k8s)集群版本</th><th>Istio软件版本</th><th>CPU架构</th></tr></thead><tbody><tr><td>CentOS</td><td>Linux</td><td>release 7.4.1708 (Core)</td><td>Docker version 20.10.12</td><td>v1.21.9 Istio1.14</td></tr></tbody></table><h2 id=三安装istio>三.安装istio</h2><p>我们有两种方法可以在单个 Kubernetes 集群上安装 Istio：使用 Istioctl（istioctl）或使用 Istio Operator。在本模块中，我们将使用 Istio Operator 在一个 Kubernetes 集群上安装 Istio。</p><p>3.1 使用 Istioctl 安装
Istioctl 是一个命令行工具，我们可以用它来安装和定制 Istio 的安装。使用该命令行工具，我们生成一个包含所有 Istio 资源的 YAML 文件，然后将其部署到 Kubernetes 集群上。</p><p>3.2 使用 Istio Operator 安装
与 istioctl 相比，Istio Operator 安装的优势在于，我们不需要手动升级 Istio。相反，我们可以部署 Istio Operator，为你管理安装。我们通过更新一个自定义资源来控制 Operator，而 Operator 则为你应用配置变化。</p><p>3.3 生产部署情况如何？
在决定 Istio 的生产部署模式时，还有一些额外的考虑因素需要牢记。我们可以配置 Istio 在不同的部署模型中运行 —— 可能跨越多个集群和网络，并使用多个控制平面。我们将在高级功能模块中了解其他部署模式、多集群安装以及在虚拟机上运行工作负载。</p><p>3.4 平台安装指南
Istio 可以安装在不同的 Kubernetes 平台上。关于特定云供应商的最新安装指南，请参考平台安装文档。</p><p><a href=https://istio.io/latest/docs/setup/platform-setup/ target=_blank rel="noopener noreffer">https://istio.io/latest/docs/setup/platform-setup/</a></p><h2 id=四getmesh>四.GetMesh</h2><p>Istio 是最受欢迎和发展最快的开源项目之一。它的发布时间表对企业的生命周期和变更管理实践来说可能非常激进。GetMesh 通过针对不同的 Kubernetes 分发版测试所有 Istio 版本以确保功能的完整性来解决这一问题。GetMesh 的 Istio 版本在安全补丁和其他错误更新方面得到积极的支持，并拥有比上游 Istio 提供的更长的支持期。</p><p>一些服务网格客户需要支持更高的安全要求。GetMesh 通过提供两种 Istio 发行版来解决合规性问题。</p><p>tetrate 发行版，跟踪上游 Istio 并可能应用额外的补丁。
tetratefips 发行版，是符合 FIPS 标准的 tetrate 版本。</p><p>4.1 如何开始使用？
第一步是下载 GetMesh CLI。你可以在 macOS 和 Linux 平台上安装 GetMesh。我们可以使用以下命令来下载最新版本的 GetMesh 和认证的 Istio。</p><p>4.2 如何开始？
第一步是下载 GetMesh CLI。你可以在 macOS 和 Linux 平台上安装 GetMesh。我们可以使用以下命令下载最新版本的 GetMesh 并认证 Istio。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#安装getmesh</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@k8scloude1 ~<span class=o>]</span><span class=c1># curl -sL https://istio.tetratelabs.io/getmesh/install.sh | bash</span>
</span></span><span class=line><span class=cl>tetratelabs/getmesh info checking GitHub <span class=k>for</span> latest tag
</span></span><span class=line><span class=cl>tetratelabs/getmesh info found version: 1.1.4 <span class=k>for</span> v1.1.4/linux/amd64
</span></span><span class=line><span class=cl>tetratelabs/getmesh info installed /root/.getmesh/bin/getmesh
</span></span><span class=line><span class=cl>tetratelabs/getmesh info updating user profile <span class=o>(</span>/root/.bash_profile<span class=o>)</span>...
</span></span><span class=line><span class=cl>tetratelabs/getmesh info the following two lines are added into your profile <span class=o>(</span>/root/.bash_profile<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GETMESH_HOME</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$HOME</span><span class=s2>/.getmesh&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$GETMESH_HOME</span><span class=s2>/bin:</span><span class=nv>$PATH</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Finished installation. Open a new terminal to start using getmesh!
</span></span></code></pre></div><p>修改配置文件使所有人都可以使用getmesh命令</p><pre tabindex=0><code>[root@k8scloude1 ~]# cd .getmesh/

[root@k8scloude1 .getmesh]# pwd
/root/.getmesh

[root@k8scloude1 .getmesh]# vim /etc/profile.d/getmesh.sh

[root@k8scloude1 .getmesh]# cat /etc/profile.d/getmesh.sh
export GETMESH_HOME=&#34;/root/.getmesh&#34;
export PATH=&#34;$GETMESH_HOME/bin:$PATH&#34;

#使配置文件生效
[root@k8scloude1 .getmesh]# source /etc/profile.d/getmesh.sh
</code></pre><p>我们可以运行 version 命令以确保 GetMesh 被成功安装。例如：</p><pre tabindex=0><code>[root@k8scloude1 .getmesh]# getmesh version
getmesh version: 1.1.4
active istioctl: 1.14.4-tetrate-v0
client version: 1.14.4-tetrate-v0
control plane version: 1.14.3
data plane version: 1.14.3 (2 proxies)
</code></pre><p>版本命令输出 GetMesh 的版本、活跃的 Istio CLI 的版本以及 Kubernetes 集群上安装的 Istio 的版本。</p><p>4.3 使用 GetMesh 安装 Istio
GetMesh 通过 Kubernetes 配置文件与活跃的 Kubernetes 集群进行通信。</p><p>要在当前活跃的 Kubernetes 集群上安装 Istio 的演示配置文件，我们可以像这样使用 getmesh istioctl 命令：</p><pre tabindex=0><code>[root@k8scloude1 .getmesh]# getmesh istioctl install --set profile=demo
</code></pre><p>该命令将检查集群，以确保它准备好安装 Istio，一旦你确认，安装程序将继续使用选定的配置文件安装 Istio。</p><p>如果我们现在检查版本，你会注意到输出显示控制平面和数据平面的版本。</p><p>4.4 验证配置
config-validate 命令允许你对当前配置和任何尚未应用的 YAML 清单进行验证。</p><p>该命令使用外部资源调用一系列验证，如上游 Istio 验证、Kiali 库和 GetMesh 自定义配置检查。</p><p>下面是一个命令输出的例子，default命名空间没有标记为 Istio 注入。</p><p>The namespace is not enabled for Istio injection. Run &lsquo;kubectl label namespace default istio-injection=enabled&rsquo; to enable it, or &lsquo;kubectl label namespace default istio-injection=disabled&rsquo; to explicitly mark it as not needing injection.这段信息告诉我们：命名空间没有启用Istio注入，可以运行”kubectl label namespace default istio-injection=enabled“命令启用Istio injection，或者运行&rsquo;kubectl label namespace default istio-injection=disabled&rsquo;命令显式地将其标记为不需要注入。</p><pre tabindex=0><code>[root@k8scloude1 ~]# getmesh config-validate
 Running the config validator. This may take some time...
 
 2021-08-02T19:20:33.873244Z     info    klog    Throttling request took 1.196458809s, request: GET:https://35.185.226.9/api/v1/namespaces/istio-system/configmaps/istio[]
 NAMESPACE       NAME    RESOURCE TYPE   ERROR CODE      SEVERITY        MESSAGE                                     
 default         default Namespace       IST0102         Info            The namespace is not enabled for Istio injection. Run &#39;kubectl label namespace default istio-injection=enabled&#39; to enable it, or &#39;kubectl label namespace default istio-injection=disabled&#39; to explicitly mark it as not needing injection.
 
 The error codes of the found issues are prefixed by &#39;IST&#39; or &#39;KIA&#39;. For the detailed explanation, please refer to
 - https://istio.io/latest/docs/reference/config/analysis/ for &#39;IST&#39; error codes
 - https://kiali.io/documentation/latest/validations/ for &#39;KIA&#39; error codes
</code></pre><p>同样，你也可以传入一个 YAML 文件来验证它，然后再将它部署到集群。例如：</p><pre tabindex=0><code>[root@k8scloude1 ~]# getmesh config-validate my-resources.yaml
</code></pre><p>4.5 管理多个 Istio CLI</p><p>我们可以使用 show 命令来列出当前下载的 Istio 版本：</p><pre tabindex=0><code>[root@k8scloude1 ~]# getmesh show
1.14.4-tetrate-v0 (Active)
</code></pre><p>如果电脑上没有我们想使用的版本，可以使用 getmesh list 命令来列出所有可信的 Istio 版本：</p><pre tabindex=0><code>[root@k8scloude1 ~]# getmesh list
 ISTIO VERSION     FLAVOR        FLAVOR VERSION     K8S VERSIONS
    *1.9.5         tetrate             0         1.17,1.18,1.19,1.20
     1.9.5          istio              0         1.17,1.18,1.19,1.20
     1.9.4         tetrate             0         1.17,1.18,1.19,1.20
     1.9.4          istio              0         1.17,1.18,1.19,1.20
     1.9.0         tetrate             0         1.17,1.18,1.19,1.20
     1.9.0       tetratefips           1         1.17,1.18,1.19,1.20
     1.9.0          istio              0         1.17,1.18,1.19,1.20
     1.8.6         tetrate             0         1.16,1.17,1.18,1.19
     1.8.6          istio              0         1.16,1.17,1.18,1.19
     1.8.5         tetrate             0         1.16,1.17,1.18,1.19
     1.8.5          istio              0         1.16,1.17,1.18,1.19
     1.8.3         tetrate             0         1.16,1.17,1.18,1.19
     1.8.3       tetratefips           1         1.16,1.17,1.18,1.19
     1.8.3          istio              0         1.16,1.17,1.18,1.19
     1.7.8         tetrate             0           1.16,1.17,1.18
     1.7.8          istio              0           1.16,1.17,1.18
</code></pre><p>要获取一个特定的版本（比方说1.9.0 tetratefips），我们可以使用 fetch 命令：</p><pre tabindex=0><code>[root@k8scloude1 ~]# getmesh fetch --version 1.9.0 --flavor tetratefips  --flavor-version 1
</code></pre><p>当上述命令完成后，GetMesh 将获取的 Istio CLI 版本设置为活跃版本。例如，运行 show 命令现在显示 tetratefips 1.9.0 版本是活跃的：</p><pre tabindex=0><code>
[root@k8scloude1 ~]# getmesh show
 1.9.0-tetratefips-v1 (Active)
 1.9.5-tetrate-v0
</code></pre><p>同样，如果我们运行 getmesh istioctl version ，我们会发现正在使用的 Istio CLI 的版本：</p><pre tabindex=0><code>
[root@k8scloude1 ~]# getmesh istioctl version
 client version: 1.9.0-tetratefips-v1
 control plane version: 1.9.5-tetrate-v0
 data plane version: 1.9.5-tetrate-v0 (2 proxies)
</code></pre><p>4.6 CA 集成
我们没有使用自签的根证书，而是从 GCP CAS（证书授权服务）获得一个中间的 Istio 证书授权（CA）来签署工作负载证书。</p><p>假设你已经配置了自己的 CAS 实例， 可以用 CA 的参数创建一个 YAML 配置。下面是 YAML 配置的一个例子：</p><p>providerName: &ldquo;gcp&rdquo;
providerConfig:
gcp:
# 你在 GCP 上创建的证书授权的完整 CA 名称
casCAName: &ldquo;projects/tetrate-io-istio/locations/us-west1/certificateAuthorities/tetrate-example-io&rdquo;</p><p>certificateParameters:
secretOptions:
istioCANamespace: &ldquo;istio-system&rdquo; # cacerts secret 所在的命名空间
overrideExistingCACertsSecret: true # 重写已存在的 cacerts secret，使用新的替换
caOptions:
validityDays: 365 # CA 到期前的有效天数
keyLength: 2048 # 创建的 key 的比特数
certSigningRequestParams: # x509.CertificateRequest；大部分字段省略
subject:
commonname: &ldquo;tetrate.example.io&rdquo;
country:
- &ldquo;US&rdquo;
locality:
- &ldquo;Sunnyvale&rdquo;
organization:
- &ldquo;Istio&rdquo;
organizationunit:
- &ldquo;engineering&rdquo;
emailaddresses:
- &ldquo;<a href=mailto:youremail@example.io rel>youremail@example.io</a>&rdquo;
配置完成后，你可以使用 gen-ca 命令来创建 cacert。</p><p>[root@k8scloude1 ~]# getmesh gen-ca &ndash;config-file gcp-cas-config.yaml
该命令在 istio-system 中创建 cacerts Kubernetes Secret。为了让 istiod 接受新的 cert，你必须重新启动 istiod。</p><p>如果你创建一个 sample 工作负载，并检查所使用的证书，你会发现是 CA 为工作负载发布的证书。</p><p>Istio CA certs 集成可用于 GCP CA 服务和 AWS Private CA 服务。</p><h2 id=五-发现选择器discovery-selectors>五. 发现选择器(Discovery Selectors)</h2><p>发现选择器是 Istio 1.10 中引入的新功能之一。发现选择器允许我们控制 Istio 控制平面观察和发送配置更新的命名空间。</p><p>默认情况下，Istio 控制平面会观察和处理集群中所有 Kubernetes 资源的更新。服务网格中的所有 Envoy代理的配置方式是，它们可以到达服务网格中的每个工作负载，并接受与工作负载相关的所有端口的流量。</p><p>例如，我们在不同的命名空间部署了两个工作负载——foo 和 bar。尽管我们知道 foo 永远不会与 bar 通信，反之亦然，但一个服务的端点将被包含在另一个服务的已发现端点列表中。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../../../static/img/istio/image-20221027174949822.png data-srcset="../../../static/img/istio/image-20221027174949822.png, ../../../static/img/istio/image-20221027174949822.png 1.5x, ../../../static/img/istio/image-20221027174949822.png 2x" data-sizes=auto alt=../../../static/img/istio/image-20221027174949822.png title=tupian></p><p>如果我们运行 istioctl proxy-config 命令，列出 foo 命名空间的 foo 工作负载可以看到的所有端点，你会注意到一个名为 bar 的服务条目：</p><pre tabindex=0><code>[root@k8scloude1 ~]# istioctl proxy-config endpoints deploy/foo.foo
 ENDPOINT                         STATUS      OUTLIER CHECK     CLUSTER
 …
 10.4.1.4:31400                   HEALTHY     OK                outbound|31400||istio-ingressgateway.istio-system.svc.cluster.local
 10.4.1.5:80                      HEALTHY     OK                outbound|80||foo.foo.svc.cluster.local
 10.4.2.2:53                      HEALTHY     OK                outbound|53||kube-dns.kube-system.svc.cluster.local
 10.4.4.2:8383                    HEALTHY     OK                outbound|8383||istio-operator.istio-operator.svc.cluster.local
 10.4.4.3:8080                    HEALTHY     OK                outbound|80||istio-egressgateway.istio-system.svc.cluster.local
 10.4.4.3:8443                    HEALTHY     OK                outbound|443||istio-egressgateway.istio-system.svc.cluster.local
 10.4.4.4:80                      HEALTHY     OK                outbound|80||bar.bar.svc.cluster.local
 ...
</code></pre><p>如果 Istio 不断用集群中每个服务的信息来更新代理，即使这些服务是不相关的，我们可以想象这将如何拖累事情。</p><p>如果这听起来很熟悉，你可能知道已经有一个解决方案了——Sidecar 资源。</p><p>我们将在后面的模块中讨论 Sidecar 资源。</p><p>5.1 配置发现选择器
发现选择器可以在 MeshConfig 中的 Mesh 层面上进行配置。它们是一个 Kubernetes 选择器的列表，指定了 Istio 在向 sidecar 推送配置时观察和更新的命名空间的集合。</p><p>就像 Sidecar 资源一样，discoverySelectors 可以用来限制被 Istio 观察和处理的项目数量。</p><p>我们可以更新 IstioOperator 以包括 discoverySelectors 字段，如下所示：</p><pre tabindex=0><code> apiVersion: install.istio.io/v1alpha1
 kind: IstioOperator
 metadata:
   namespace: istio-system
   name: istio-demo
 spec:
   meshConfig:
     discoverySelectors:
     - matchLabels:
         env: test
</code></pre><p>上面的例子将 env=test 设置为一个匹配标签。这意味着标有 env=test 标签的命名空间中的工作负载将被包含在 Istio 监控和更新的命名空间列表中。</p><p>如果我们给 foo 命名空间贴上 env=test 标签，然后列出端点，我们会发现现在配置中列出的端点没有那么多。这是因为我们标注的唯一命名空间是 foo 命名空间，这也是 Istio 控制平面观察和发送更新的唯一命名空间。</p><pre tabindex=0><code>[root@k8scloude1 ~]# istioctl proxy-config endpoints deploy/foo.foo
 ENDPOINT                         STATUS      OUTLIER CHECK     CLUSTER
 10.4.1.5:80                      HEALTHY     OK                outbound|80||foo.foo.svc.cluster.local
 127.0.0.1:15000                  HEALTHY     OK                prometheus_stats
 127.0.0.1:15020                  HEALTHY     OK                agent
 unix://./etc/istio/proxy/SDS     HEALTHY     OK                sds-grpc
 unix://./etc/istio/proxy/XDS     HEALTHY     OK                xds-grpc
</code></pre><p>如果我们把命名空间 bar 也贴上标签，然后重新运行 istioctl proxy-config 命令，我们会发现 bar 端点显示为 foo 服务配置的一部分。</p><pre tabindex=0><code>
[root@k8scloude1 ~]# istioctl proxy-config endpoints deploy/foo.foo
 ENDPOINT                         STATUS      OUTLIER CHECK     CLUSTER
 10.4.1.5:80                      HEALTHY     OK                outbound|80||foo.foo.svc.cluster.local
 10.4.4.4:80                      HEALTHY     OK                outbound|80||bar.bar.svc.cluster.local
 127.0.0.1:15000                  HEALTHY     OK                prometheus_stats
 127.0.0.1:15020                  HEALTHY     OK                agent
 unix://./etc/istio/proxy/SDS     HEALTHY     OK                sds-grpc
 unix://./etc/istio/proxy/XDS     HEALTHY     OK                xds-grpc
</code></pre><h2 id=六实战k8s集群安装istio-114版本>六.实战（k8s集群安装Istio 1.14版本）</h2><p>要安装 Istio，我们需要一个运行中的 Kubernetes 集群实例。所有的云供应商都提供托管的 Kubernetes 集群，我们可以用它来安装 Istio 服务网格。</p><p>我们也可以在自己的电脑上使用以下任意平台在本地运行 Kubernetes集群：</p><ul><li>Minikube</li><li>Docker Desktop</li><li>kind</li><li>MicroK8s</li></ul><p>当使用本地 Kubernetes 集群时，确保你的电脑满足 Istio 安装的最低要求（如 16384MB 内存和 4 个 CPU）。另外，确保 Kubernetes 集群的版本大于等于 v1.19.0。</p><p>6.1 Kubernetes 集群(1.21.9版本)
安装istio的前提是已经有一套可以正常运行的Kubernetes集群，关于Kubernetes(k8s)集群的安装部署，可以查看博客《Centos7 安装部署Kubernetes(k8s)集群》https://www.cnblogs.com/renshengdezheli/p/16686769.html</p><p>Kubernetes集群版本为1.21.9</p><pre tabindex=0><code>[root@k8scloude1 ~]# kubectl get node
NAME         STATUS   ROLES                  AGE    VERSION
k8scloude1   Ready    control-plane,master   255d   v1.21.9
k8scloude2   Ready    &lt;none&gt;                 255d   v1.21.9
k8scloude3   Ready    &lt;none&gt;                 255d   v1.21.9
</code></pre><p>Kubernetes CLI是kubectl工具，我们可以运行 kubectl version 来查看kubectl的版本</p><pre tabindex=0><code>[root@k8scloude1 ~]# kubectl version 
Client Version: version.Info{Major:&#34;1&#34;, Minor:&#34;21&#34;, GitVersion:&#34;v1.21.9&#34;, GitCommit:&#34;b631974d68ac5045e076c86a5c66fba6f128dc72&#34;, GitTreeState:&#34;clean&#34;, BuildDate:&#34;2022-01-19T17:51:12Z&#34;, GoVersion:&#34;go1.16.12&#34;, Compiler:&#34;gc&#34;, Platform:&#34;linux/amd64&#34;}
Server Version: version.Info{Major:&#34;1&#34;, Minor:&#34;21&#34;, GitVersion:&#34;v1.21.9&#34;, GitCommit:&#34;b631974d68ac5045e076c86a5c66fba6f128dc72&#34;, GitTreeState:&#34;clean&#34;, BuildDate:&#34;2022-01-19T17:45:53Z&#34;, GoVersion:&#34;go1.16.12&#34;, Compiler:&#34;gc&#34;, Platform:&#34;linux/amd64&#34;}
</code></pre><p>6.2 Istio 版本支持状态</p><p>Istio最新版本为1.15，因为我们Kubernetes集群版本为1.21.9，所以我们选择安装Istio 1.14版本。</p><p>Kubernetes 1.22 删除了一些已弃用的 API，因此 1.10.0 之前的 Istio 版本将不再工作。如果您正在升级 Kubernetes 版本，请确保 Istio 的版本仍然受到支持。</p><p>istio各个版本的归档可以查看：https://istio.io/archive/</p><p>6.3 下载 Istio
在本实验中，我们将使用 Istio 1.14版本。安装 Istio 的第一步是下载 Istio CLI（istioctl）、安装清单、示例和工具。</p><p>安装最新版本的最简单方法是使用 downloadIstio 脚本。打开一个终端窗口，打开你要下载 Istio 的文件夹，然后运行下载脚本。</p><p>下载istio最新版本命令为：</p><p>[root@k8scloude1 ~]# curl -L <a href=https://istio.io/downloadIstio target=_blank rel="noopener noreffer">https://istio.io/downloadIstio</a> | sh -
您可以在命令行上传递变量以下载特定版本或覆盖处理器架构。例如，要下载 x86_64 架构的 Istio 1.14.3，请运行：</p><p>[root@k8scloude1 ~]# curl -L <a href=https://istio.io/downloadIstio target=_blank rel="noopener noreffer">https://istio.io/downloadIstio</a> | ISTIO_VERSION=1.14.3 TARGET_ARCH=x86_64 sh -
或者直接去https://github.com/istio/istio/releases/download/1.14.3/istio-1.14.3-linux-amd64.tar.gz下载安装包,下载安装包之后解压，istio-1.14.3/bin目录下可以看到istioctl，istio-1.14.3/samples目录下是示例应用程序。</p><pre tabindex=0><code>[root@k8scloude1 ~]# ll -h istio-1.14.3-linux-amd64.tar.gz 
-rw-r--r-- 1 root root 23M 9月  22 11:34 istio-1.14.3-linux-amd64.tar.gz

[root@k8scloude1 ~]# tar xf istio-1.14.3-linux-amd64.tar.gz 

[root@k8scloude1 ~]# ls 
istio-1.14.3-linux-amd64.tar.gz  istio-1.14.3

[root@k8scloude1 ~]# cd istio-1.14.3/

[root@k8scloude1 istio-1.14.3]# ls
bin  LICENSE  manifests  manifest.yaml  README.md  samples  tools

[root@k8scloude1 istio-1.14.3]# ls bin/
istioctl
为了访问 istioctl，我们应该把它添加到 path 中。

[root@k8scloude1 bin]# pwd
/root/istio-1.14.3/bin

[root@k8scloude1 bin]# ls
istioctl

#临时生效
[root@k8scloude1 bin]# export PATH=/root/istio-1.14.3/bin:$PATH

#永久生效
[root@k8scloude1 bin]# vim /etc/profile.d/istioctl.sh

[root@k8scloude1 bin]# cat /etc/profile.d/istioctl.sh
export ISTIOCTL_HOME=&#34;/root/istio-1.14.3&#34;
export PATH=&#34;$ISTIOCTL_HOME/bin:$PATH&#34;

[root@k8scloude1 bin]# source /etc/profile.d/istioctl.sh
</code></pre><p>要检查 istioctl 是否在 path 里，运行 istioctl version。你应该看到这样的输出。</p><pre tabindex=0><code>[root@k8scloude1 bin]# istioctl version
no running Istio pods in &#34;istio-system&#34;
</code></pre><p>1.14.3
6.4 安装 Istio
Istio 支持多个配置文件（profile）。配置文件之间的区别在于所安装的组件。</p><pre tabindex=0><code>[root@k8scloude1 bin]# istioctl profile list

Istio configuration profiles:

    default
    demo
    empty
    external
    minimal
    openshift
    preview
    remote
</code></pre><p>这些配置文件提供了对 Istio 控制平面和 Istio 数据平面 Sidecar 的定制内容。</p><p>您可以从 Istio 内置配置文件的其中一个开始入手，然后根据您的特定需求进一步自定义配置文件。当前提供以下几种内置配置文件：</p><p>default：根据 IstioOperator API 的默认设置启动组件。 建议用于生产部署和 Multicluster Mesh 中的 Primary Cluster。</p><p>您可以运行 istioctl profile dump 命令来查看默认设置。</p><p>demo：这一配置具有适度的资源需求，旨在展示 Istio 的功能。 它适合运行 Bookinfo 应用程序和相关任务。 这是通过快速开始指导安装的配置。此配置文件启用了高级别的追踪和访问日志，因此不适合进行性能测试。</p><p>minimal：与默认配置文件相同，但只安装了控制平面组件。 它允许您使用 Separate Profile 配置控制平面和数据平面组件(例如 Gateway)。</p><p>remote：配置 Multicluster Mesh 的 Remote Cluster。</p><p>empty：不部署任何东西。可以作为自定义配置的基本配置文件。</p><p>preview：预览文件包含的功能都是实验性。这是为了探索 Istio 的新功能。不确保稳定性、安全性和性能（使用风险需自负）。</p><p>标注 ✔ 的组件安装在每个配置文件中</p><table><thead><tr><th>名字</th><th>default</th><th>emo</th><th>minimal</th><th>remote</th><th>empty</th><th>preview</th></tr></thead><tbody><tr><td>核心组件</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>istio-egressgateway</td><td></td><td>✔</td><td></td><td></td><td></td><td></td></tr><tr><td>istio-ingressgateway</td><td>✔</td><td>✔</td><td></td><td></td><td></td><td>✔</td></tr><tr><td>istiod</td><td>✔</td><td>✔</td><td>✔</td><td></td><td></td><td>✔</td></tr></tbody></table><p>推荐用于生产部署的配置文件是 default 配置文件。</p><p>我们将安装 demo 配置文件，因为它包含所有的核心组件，启用了跟踪和日志记录，便于学习不同的 Istio 功能。</p><p>我们也可以从 minimal 的组件开始，以后单独安装其他功能，如 ingress 和 egress 网关。</p><p>因为我们将使用 Istio Operator 进行安装，所以我们必须先部署 Operator。关于Istio Operator 简介可以查看https://istio.io/v1.14/zh/blog/2019/introducing-istio-operator/</p><p>要部署 Istio Operator，请运行：</p><pre tabindex=0><code>[root@k8scloude1 bin]# istioctl operator init
Installing operator controller in namespace: istio-operator using image: docker.io/istio/operator:1.14.3
Operator controller will watch namespaces: istio-system
✔ Istio operator installed                                                                                                                                                                                       
✔ Installation complete
</code></pre><p>init 命令创建了 istio-operator 命名空间，并部署了 CRD、Operator Deployment 以及 operator 工作所需的其他资源。安装完成后，Operator 就可以使用了。</p><p>要安装 Istio，我们必须创建 IstioOperator 资源，并指定我们要使用的配置文件。</p><p>创建一个名为 istio-demo-profile.yaml的文件，内容如下：</p><pre tabindex=0><code>#创建目录istioyaml，用来专门存放yaml文件
[root@k8scloude1 ~]# mkdir istioyaml

[root@k8scloude1 ~]# cd istioyaml/

[root@k8scloude1 istioyaml]# vim istio-demo-profile.yaml  

#profile: demo表示使用demo配置文件安装istio
[root@k8scloude1 istioyaml]# cat istio-demo-profile.yaml 
apiVersion: v1
kind: Namespace
metadata:
  name: istio-system
---
apiVersion: install.istio.io/v1alpha1
kind: IstioOperator
metadata:
  namespace: istio-system
  name: demo-istio-install
spec:
  profile: demo
</code></pre><p>我们还在文件中添加了命名空间资源，以创建 istio-system 命名空间。</p><p>我们需要做的最后一件事是创建资源：</p><p>[root@k8scloude1 istioyaml]# kubectl apply -f istio-demo-profile.yaml
Warning: resource namespaces/istio-system is missing the kubectl.kubernetes.io/last-applied-configuration annotation which is required by kubectl apply. kubectl apply should only be used on resources created declaratively by either kubectl create &ndash;save-config or kubectl apply. The missing annotation will be patched automatically.
namespace/istio-system configured
istiooperator.install.istio.io/demo-istio-install created</p><pre tabindex=0><code>#可以查看istio-system命名空间下的所有资源
[root@k8scloude1 istioyaml]# kubectl get all -o wide -n istio-system 
NAME                                        READY   STATUS    RESTARTS   AGE     IP               NODE         NOMINATED NODE   READINESS GATES
pod/istio-egressgateway-58949b7c84-k7v6f    1/1     Running   0          3m38s   10.244.112.173   k8scloude2   &lt;none&gt;           &lt;none&gt;
pod/istio-ingressgateway-75bc568988-9j4wv   1/1     Running   0          3m38s   10.244.251.238   k8scloude3   &lt;none&gt;           &lt;none&gt;
pod/istiod-84d979766b-kz5sd                 1/1     Running   0          4m20s   10.244.112.130   k8scloude2   &lt;none&gt;           &lt;none&gt;

NAME                           TYPE           CLUSTER-IP      EXTERNAL-IP       PORT(S)                                                                      AGE     SELECTOR
service/istio-egressgateway    ClusterIP      10.102.56.241   &lt;none&gt;            80/TCP,443/TCP                                                               3m35s   app=istio-egressgateway,istio=egressgateway
service/istio-ingressgateway   LoadBalancer   10.107.131.65   192.168.110.190   15021:30093/TCP,80:32126/TCP,443:30293/TCP,31400:30628/TCP,15443:30966/TCP   3m35s   app=istio-ingressgateway,istio=ingressgateway
service/istiod                 ClusterIP      10.103.37.59    &lt;none&gt;            15010/TCP,15012/TCP,443/TCP,15014/TCP                                        4m21s   app=istiod,istio=pilot

NAME                                   READY   UP-TO-DATE   AVAILABLE   AGE     CONTAINERS    IMAGES                           SELECTOR
deployment.apps/istio-egressgateway    1/1     1            1           3m39s   istio-proxy   docker.io/istio/proxyv2:1.14.3   app=istio-egressgateway,istio=egressgateway
deployment.apps/istio-ingressgateway   1/1     1            1           3m39s   istio-proxy   docker.io/istio/proxyv2:1.14.3   app=istio-ingressgateway,istio=ingressgateway
deployment.apps/istiod                 1/1     1            1           4m21s   discovery     docker.io/istio/pilot:1.14.3     istio=pilot

NAME                                              DESIRED   CURRENT   READY   AGE     CONTAINERS    IMAGES                           SELECTOR
replicaset.apps/istio-egressgateway-58949b7c84    1         1         1       3m39s   istio-proxy   docker.io/istio/proxyv2:1.14.3   app=istio-egressgateway,istio=egressgateway,pod-template-hash=58949b7c84
replicaset.apps/istio-ingressgateway-75bc568988   1         1         1       3m39s   istio-proxy   docker.io/istio/proxyv2:1.14.3   app=istio-ingressgateway,istio=ingressgateway,pod-template-hash=75bc568988
replicaset.apps/istiod-84d979766b                 1         1         1       4m21s   discovery     docker.io/istio/pilot:1.14.3     istio=pilot,pod-template-hash=84d979766b
</code></pre><p>一旦 Operator 检测到 IstioOperator 资源，它将开始安装 Istio。整个过程可能需要5分钟左右。</p><p>为了检查安装的状态，我们可以看看 istio-system 命名空间中的 Pod 的状态。</p><pre tabindex=0><code>[root@k8scloude1 istioyaml]# kubectl get pod -o wide -n istio-system 
NAME                                    READY   STATUS    RESTARTS   AGE     IP               NODE         NOMINATED NODE   READINESS GATES
istio-egressgateway-58949b7c84-k7v6f    1/1     Running   0          9m20s   10.244.112.173   k8scloude2   &lt;none&gt;           &lt;none&gt;
istio-ingressgateway-75bc568988-9j4wv   1/1     Running   0          9m20s   10.244.251.238   k8scloude3   &lt;none&gt;           &lt;none&gt;
istiod-84d979766b-kz5sd                 1/1     Running   0          10m     10.244.112.130   k8scloude2   &lt;none&gt;           &lt;none&gt;
</code></pre><p>当所有的 Pod 都在运行时，Operator 已经完成了 Istio 的安装。</p><p>6.5 启用 sidecar 注入
服务网格需要让每个应用程序同时运行 sidecar 代理。</p><p>要将 sidecar 代理注入到现有的 Kubernetes 部署中，我们可以使用 istioctl 命令中的 kube-inject 动作。</p><p>然而，我们也可以在任意 Kubernetes 命名空间上启用 sidecar 自动注入。如果我们用 istio-injection=enabled 标记命名空间，Istio 会自动为我们在该命名空间中创建的所有 Kubernetes Pod 注入 sidecar。
让我们通过添加标签来启用 microservice 命名空间的 sidecar 自动注入。</p><pre tabindex=0><code>#创建命名空间
[root@k8scloude1 istioyaml]# kubectl create ns microservice
namespace/microservice created

[root@k8scloude1 istioyaml]# kubectl label namespace microservice istio-injection=enabled
namespace/microservice labeled
</code></pre><p>要检查命名空间是否被标记，请运行下面的命令。microservice 命名空间应该是唯一一个启用了该值的命名空间。</p><pre tabindex=0><code>[root@k8scloude1 istioyaml]# kubectl get namespace -L istio-injection
NAME                   STATUS   AGE     ISTIO-INJECTION
app-team1              Active   163d    
microservice           Active   3m39s   enabled
my-app                 Active   162d    
network                Active   219d    
ns1                    Active   256d    

#或者这样查询
[root@k8scloude1 istioyaml]# kubectl get namespace -l istio-injection=enabled
NAME           STATUS   AGE
microservice   Active   6m56s
</code></pre><p>现在我们可以尝试在 microservice 命名空间创建一个 Deployment，并观察注入的代理。我们将创建一个名为 mynginx 的 Deployment，使用hub.c.163.com/library/nginx:latest镜像的单一容器。</p><pre tabindex=0><code> [root@k8scloude1 istioyaml]# kubectl create deployment mynginx --image=hub.c.163.com/library/nginx:latest -n microservice
deployment.apps/mynginx created
</code></pre><p>如果我们看一下 Pod，你会发现 Pod 里有两个容器。</p><pre tabindex=0><code>[root@k8scloude1 istioyaml]# kubectl get deployment -n microservice 
NAME      READY   UP-TO-DATE   AVAILABLE   AGE
mynginx   1/1     1            1           27s

[root@k8scloude1 istioyaml]# kubectl get pod -n microservice 
NAME                       READY   STATUS    RESTARTS   AGE
mynginx-5cb948ffc5-wv29l   2/2     Running   0          35s
</code></pre><p>同样地，描述 Pod 时会显示 Kubernetes 同时创建了一个 nginx 容器和一个 istio-proxy 容器：</p><pre tabindex=0><code>[root@k8scloude1 istioyaml]# kubectl describe pod mynginx-5cb948ffc5-wv29l -n microservice 
Name:         mynginx-5cb948ffc5-wv29l
......
Events:
  Type    Reason     Age   From               Message
  ----    ------     ----  ----               -------
  Normal  Scheduled  12m   default-scheduler  Successfully assigned microservice/mynginx-5cb948ffc5-wv29l to k8scloude2
  Normal  Pulled     12m   kubelet            Container image &#34;docker.io/istio/proxyv2:1.14.3&#34; already present on machine
  Normal  Created    12m   kubelet            Created container istio-init
  Normal  Started    12m   kubelet            Started container istio-init
  Normal  Pulling    12m   kubelet            Pulling image &#34;hub.c.163.com/library/nginx:latest&#34;
  Normal  Pulled     12m   kubelet            Successfully pulled image &#34;hub.c.163.com/library/nginx:latest&#34; in 2.24360029s
  Normal  Created    12m   kubelet            Created container nginx
  Normal  Started    12m   kubelet            Started container nginx
  Normal  Pulled     12m   kubelet            Container image &#34;docker.io/istio/proxyv2:1.14.3&#34; already present on machine
  Normal  Created    12m   kubelet            Created container istio-proxy
  Normal  Started    12m   kubelet            Started container istio-proxy
运行下面的命令，删除deployment：

[root@k8scloude1 istioyaml]# kubectl delete deployment mynginx -n microservice 
deployment.apps &#34;mynginx&#34; deleted

[root@k8scloude1 istioyaml]# kubectl get deployment -n microservice 
No resources found in microservice namespace.

[root@k8scloude1 istioyaml]# kubectl get pod -n microservice 
No resources found in microservice namespace.
</code></pre><p>6.6 更新和卸载 Istio
如果我们想更新当前的安装或改变配置文件，那么需要更新先前部署的 IstioOperator 资源。</p><p>要删除安装，我们必须删除 IstioOperator，例如：</p><pre tabindex=0><code>[root@k8scloude1 istioyaml]# kubectl get istiooperator -n istio-system 
NAME                 REVISION   STATUS    AGE
demo-istio-install              HEALTHY   45m

[root@k8scloude1 istioyaml]# kubectl delete istiooperator demo-istio-install -n istio-system    
</code></pre><p>在 Operator 删除了Istio 后，运行下面的命令来删除 Operator：</p><pre tabindex=0><code>[root@k8scloude1 istioyaml]# istioctl operator remove   
</code></pre><p>请确保在删除 Operator 之前先删除 IstioOperator 资源。否则，可能会有剩余的 Istio 资源。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-02-03</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://blog.yudlk.com/posts/istio/002-install/ data-title=在Kubernetes(k8s)集群上安装部署istio1.14 data-hashtags=istio><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://blog.yudlk.com/posts/istio/002-install/ data-hashtag=istio><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://blog.yudlk.com/posts/istio/002-install/ data-title=在Kubernetes(k8s)集群上安装部署istio1.14><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://blog.yudlk.com/posts/istio/002-install/ data-title=在Kubernetes(k8s)集群上安装部署istio1.14><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://blog.yudlk.com/posts/istio/002-install/ data-title=在Kubernetes(k8s)集群上安装部署istio1.14><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/istio/>istio</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/istio/001-describe/ class=prev rel=prev title="服务网格和 Istio 概述"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>服务网格和 Istio 概述</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.100.2">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2018 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://github.com/barrypt target=_blank>qpt</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.480e58b2c2a8605d406f34667e92ff8f1ae50cfee5b653bead570f004839a983.js integrity="sha256-SA5YssKoYF1AbzRmfpL/jxrlDP7ltlO+rVcPAEg5qYM="></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-FL23FNP7CM',{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-FL23FNP7CM" async></script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?4b7c98449a6edf8492a8f3404e6d06a0",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7693630257897132" crossorigin=anonymous></script></body></html>